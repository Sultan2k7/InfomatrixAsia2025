datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum Role {
  USER
  ADMIN
  MANAGER
  DRIVER
}

model User {
  id            String    @id @default(cuid())
  name          String?
  email         String?   @unique
  password      String?
  emailVerified DateTime?
  image         String?
  role          Role      @default(USER)
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt
  Request       Request[]
}

model Request {
  id          String   @id @default(cuid())
  user        User?     @relation(fields: [userId], references: [id])
  userId      String
  title       String
  description String
  status      String
  type        String
  urgency     String
  media       Json
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

model Vehicle {
  id             String   @id @default(cuid())
  driverId       String?  // Assuming driverId is a String based on previous context
  driver         Driver?  @relation(fields: [driverId], references: [id])
  vehicleNumber  String?  @default("UNKNOWN")
  currentMission String?
  location       String?
  latitude       Float?
  longitude      Float?
  startLatitude  Float?
  startLongitude Float?
  endLatitude    Float?
  endLongitude   Float?
  speed          Int?     @default(0)
  malfunctions   Int?     // Assuming malfunctions is an Int
  vehicleType    String?
  status         String?  @default("active")
  route          Json?
  routeIndex     Int?
  bearing        Float?
  weather        Json?
  engineLoad     Int?
  arrivalTime    String?  // Assuming arrivalTime is stored as a String
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
}

model Driver {
  id             String   @id @default(cuid()) // Ensure this is also a String
  name           String
  department     String
  experience     String
  DateoOfBirth   DateTime @default(now())
  phoneNumber    String
  vehicles       Vehicle[] // Back-reference
}

model Report {
  id                           Int      @id @default(autoincrement())
  vehicle_id                   Int
  driver_id                    Int 
  job_id                       Int
  type                         String
  time                         DateTime @default(now())
  location                     String
  media                        String
  status                       String
}

model Document {
  id                           Int      @id @default(autoincrement())
  name                         String
  description                  String
}

model Obd {
  id                           Int      @id @default(autoincrement())
  vehicle_id                   String
  engineRpm                    Float
  vehicleSpeed                 Float
  throttlePosition             Float
  fuelLevel                    Float
  shortTrim1                   Float?   // Ensure this exists and matches exactly
  longTrim1                    Float?
  shortTrim2                   Float?
  longTrim2                    Float?
  engineLoad                   Float
  intakeAirTemperature         Float
  massAirFlow                  Float
  fuelPressure                 Float
  fuelConsumptionRate          Float
  engineCoolantTemperature     Float
  oxygenSensorReading          Float
  catalystTemperature          Float
  evapEmissionControlPressure  Float
  diagnosticTroubleCode        String
  batteryVoltage               Float
  oilTemperature               Float
  distanceTraveled             Float
  time                         DateTime? @default(now())
  createdAt                    DateTime  @default(now())
  updatedAt                    DateTime  @updatedAt
}




model Gps {
  id          String   @id @default(cuid())
  vehicleId   String   
  latitude    Float
  longitude   Float
  altitude    Float?
  speed       Float?
  timestamp   DateTime @default(now())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}


model Routes{
  id                           Int      @id @default(autoincrement())
  vehicleId                    String
  driver_id                    String
  startingLocation             Json
  endingLocation               Json
  startingTime                 DateTime
  endingTime                   DateTime
  createdAt                    DateTime @default(now())
  updatedAt                    DateTime @updatedAt
}


model Obd_fuel {
  id                           Int      @id @default(autoincrement())
  vehicle_id                   String
  engineRpm                    Int
  fuelLevel                    Int
  engineLoad                   Int
  massAirFlow                  Float    // Changed to Float
  fuelPressure                 Int
  fuelConsumptionRate          Float    // Changed to Float
  diagnosticTroubleCode        String
  absStatus                    Boolean
  tirePressure                 Int
  distanceTraveled             Float    // Changed to Float
  time                         DateTime @default(now())
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}


model Obd_check{
  id                           Int   @id @default(autoincrement())
  all                          Json
  createdAt   DateTime @default(now())
}



model obd_checktest{
  id                          Int @id @default(autoincrement())
  all                         Json
  createdAt    DateTime @default(now())
}